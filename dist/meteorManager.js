"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _runtime = _interopRequireDefault(require("regenerator-runtime/runtime"));
var _fs = _interopRequireDefault(require("fs"));
var _crossSpawn = _interopRequireDefault(require("cross-spawn"));
var _log = _interopRequireDefault(require("./log"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
// eslint-disable-next-line no-unused-vars

/**
 * Utility class designed for managing Meteor packages.
 *
 * @property {MeteorDesktop} $
 * @class
 */
class MeteorManager {
  /**
   * @param {MeteorDesktop} $ - context
   * @constructor
   */
  constructor($) {
    this.log = new _log.default('meteorManager');
    this.$ = $;
  }

  /**
   * Looks for specified packages in .meteor/packages. In other words checks if the project has
   * specified packages added.
   * @param {Array} packages
   * @returns {boolean}
   */
  checkPackages(packages) {
    const usedPackages = _fs.default.readFileSync(this.$.env.paths.meteorApp.packages, 'UTF-8').replace(/\r/gm, '').split('\n').filter(line => !line.trim().startsWith('#'));
    return !packages.some(packageToFind => !usedPackages.some(meteorPackage => ~meteorPackage.indexOf(packageToFind)));
  }

  /**
   * Looks for specified packages in .meteor/packages. In other words checks if the project has
   * specified packages added.
   * @param {Array} packages
   * @returns {boolean}
   */
  checkPackagesVersion(packages) {
    const usedPackages = _fs.default.readFileSync(this.$.env.paths.meteorApp.versions, 'UTF-8').replace(/\r/gm, '').split('\n');
    return !packages.some(packageToFind => !usedPackages.some(meteorPackage => meteorPackage === packageToFind));
  }

  /**
   * Ensures certain packages are added to meteor project and in correct version.
   * @param {Array} packages
   * @param {Array} packagesWithVersion
   * @param {string} who - name of the entity that requests presence of thos packages (can be the
   *                       integration itself or a plugin)
   * @returns {Promise.<void>}
   */
  async ensurePackages(packages, packagesWithVersion, who) {
    if (!this.checkPackages(packages)) {
      this.log.warn(`${who} requires some packages that are not added to project, will try to add them now`);
      try {
        await this.addPackages(packages, packagesWithVersion);
      } catch (e) {
        throw new Error(e);
      }
    }
    if (!this.checkPackagesVersion(packagesWithVersion)) {
      this.log.warn(`${who} required packages version is different, fixing it`);
      try {
        await this.addPackages(packages, packagesWithVersion);
      } catch (e) {
        throw new Error(e);
      }
    }
  }

  /**
   * Removes packages from the meteor app.
   * @param {Array} packages            - array with names of the packages to remove
   */
  deletePackages(packages) {
    this.log.warn('removing packages from meteor project', ...packages);
    return new Promise((resolve, reject) => {
      (0, _crossSpawn.default)('meteor', ['remove'].concat(packages), {
        cwd: this.$.env.paths.meteorApp.root,
        stdio: ['pipe', 'pipe', process.stderr],
        env: Object.assign({
          METEOR_PRETTY_OUTPUT: 0,
          METEOR_NO_RELEASE_CHECK: 1
        }, process.env)
      }).on('exit', code => {
        if (code !== 0 || this.checkPackages(packages)) {
          reject('removing packages failed');
        } else {
          resolve();
        }
      });
    });
  }

  /**
   * Adds packages to the meteor app.
   * @param {Array} packages            - array with names of the packages to add
   * @param {Array} packagesWithVersion - array with names and versions of the packages to add
   */
  addPackages(packages, packagesWithVersion) {
    this.log.info('adding packages to meteor project', ...packagesWithVersion);
    return new Promise((resolve, reject) => {
      (0, _crossSpawn.default)('meteor', ['add'].concat(packagesWithVersion.map(packageName => packageName.replace('@', '@='))), {
        cwd: this.$.env.paths.meteorApp.root,
        stdio: ['pipe', 'pipe', process.stderr],
        env: Object.assign({
          METEOR_PRETTY_OUTPUT: 0,
          METEOR_NO_RELEASE_CHECK: 1
        }, process.env)
      }).on('exit', code => {
        if (code !== 0 || !this.checkPackages(packages)) {
          reject('adding packages failed');
        } else {
          resolve();
        }
      });
    });
  }
}
exports.default = MeteorManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcnVudGltZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2ZzIiwiX2Nyb3NzU3Bhd24iLCJfbG9nIiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJNZXRlb3JNYW5hZ2VyIiwiY29uc3RydWN0b3IiLCIkIiwibG9nIiwiTG9nIiwiY2hlY2tQYWNrYWdlcyIsInBhY2thZ2VzIiwidXNlZFBhY2thZ2VzIiwiZnMiLCJyZWFkRmlsZVN5bmMiLCJlbnYiLCJwYXRocyIsIm1ldGVvckFwcCIsInJlcGxhY2UiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0cmltIiwic3RhcnRzV2l0aCIsInNvbWUiLCJwYWNrYWdlVG9GaW5kIiwibWV0ZW9yUGFja2FnZSIsImluZGV4T2YiLCJjaGVja1BhY2thZ2VzVmVyc2lvbiIsInZlcnNpb25zIiwiZW5zdXJlUGFja2FnZXMiLCJwYWNrYWdlc1dpdGhWZXJzaW9uIiwid2hvIiwid2FybiIsImFkZFBhY2thZ2VzIiwiZSIsIkVycm9yIiwiZGVsZXRlUGFja2FnZXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInNwYXduIiwiY29uY2F0IiwiY3dkIiwicm9vdCIsInN0ZGlvIiwicHJvY2VzcyIsInN0ZGVyciIsIk9iamVjdCIsImFzc2lnbiIsIk1FVEVPUl9QUkVUVFlfT1VUUFVUIiwiTUVURU9SX05PX1JFTEVBU0VfQ0hFQ0siLCJvbiIsImNvZGUiLCJpbmZvIiwibWFwIiwicGFja2FnZU5hbWUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vbGliL21ldGVvck1hbmFnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG5pbXBvcnQgcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gJ3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHNwYXduIGZyb20gJ2Nyb3NzLXNwYXduJztcblxuaW1wb3J0IExvZyBmcm9tICcuL2xvZyc7XG5cbi8qKlxuICogVXRpbGl0eSBjbGFzcyBkZXNpZ25lZCBmb3IgbWFuYWdpbmcgTWV0ZW9yIHBhY2thZ2VzLlxuICpcbiAqIEBwcm9wZXJ0eSB7TWV0ZW9yRGVza3RvcH0gJFxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1ldGVvck1hbmFnZXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7TWV0ZW9yRGVza3RvcH0gJCAtIGNvbnRleHRcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigkKSB7XG4gICAgICAgIHRoaXMubG9nID0gbmV3IExvZygnbWV0ZW9yTWFuYWdlcicpO1xuICAgICAgICB0aGlzLiQgPSAkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvb2tzIGZvciBzcGVjaWZpZWQgcGFja2FnZXMgaW4gLm1ldGVvci9wYWNrYWdlcy4gSW4gb3RoZXIgd29yZHMgY2hlY2tzIGlmIHRoZSBwcm9qZWN0IGhhc1xuICAgICAqIHNwZWNpZmllZCBwYWNrYWdlcyBhZGRlZC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYWNrYWdlc1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGNoZWNrUGFja2FnZXMocGFja2FnZXMpIHtcbiAgICAgICAgY29uc3QgdXNlZFBhY2thZ2VzID0gZnNcbiAgICAgICAgICAgIC5yZWFkRmlsZVN5bmModGhpcy4kLmVudi5wYXRocy5tZXRlb3JBcHAucGFja2FnZXMsICdVVEYtOCcpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxyL2dtLCAnJylcbiAgICAgICAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiAhbGluZS50cmltKCkuc3RhcnRzV2l0aCgnIycpKTtcbiAgICAgICAgcmV0dXJuICFwYWNrYWdlcy5zb21lKFxuICAgICAgICAgICAgcGFja2FnZVRvRmluZCA9PlxuICAgICAgICAgICAgICAgICF1c2VkUGFja2FnZXMuc29tZShtZXRlb3JQYWNrYWdlID0+IH5tZXRlb3JQYWNrYWdlLmluZGV4T2YocGFja2FnZVRvRmluZCkpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9va3MgZm9yIHNwZWNpZmllZCBwYWNrYWdlcyBpbiAubWV0ZW9yL3BhY2thZ2VzLiBJbiBvdGhlciB3b3JkcyBjaGVja3MgaWYgdGhlIHByb2plY3QgaGFzXG4gICAgICogc3BlY2lmaWVkIHBhY2thZ2VzIGFkZGVkLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2thZ2VzXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICovXG4gICAgY2hlY2tQYWNrYWdlc1ZlcnNpb24ocGFja2FnZXMpIHtcbiAgICAgICAgY29uc3QgdXNlZFBhY2thZ2VzID0gZnMucmVhZEZpbGVTeW5jKHRoaXMuJC5lbnYucGF0aHMubWV0ZW9yQXBwLnZlcnNpb25zLCAnVVRGLTgnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcci9nbSwgJycpXG4gICAgICAgICAgICAuc3BsaXQoJ1xcbicpO1xuICAgICAgICByZXR1cm4gIXBhY2thZ2VzLnNvbWUoXG4gICAgICAgICAgICBwYWNrYWdlVG9GaW5kID0+ICF1c2VkUGFja2FnZXMuc29tZShtZXRlb3JQYWNrYWdlID0+IG1ldGVvclBhY2thZ2UgPT09IHBhY2thZ2VUb0ZpbmQpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5zdXJlcyBjZXJ0YWluIHBhY2thZ2VzIGFyZSBhZGRlZCB0byBtZXRlb3IgcHJvamVjdCBhbmQgaW4gY29ycmVjdCB2ZXJzaW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2thZ2VzXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFja2FnZXNXaXRoVmVyc2lvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB3aG8gLSBuYW1lIG9mIHRoZSBlbnRpdHkgdGhhdCByZXF1ZXN0cyBwcmVzZW5jZSBvZiB0aG9zIHBhY2thZ2VzIChjYW4gYmUgdGhlXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgIGludGVncmF0aW9uIGl0c2VsZiBvciBhIHBsdWdpbilcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZS48dm9pZD59XG4gICAgICovXG4gICAgYXN5bmMgZW5zdXJlUGFja2FnZXMocGFja2FnZXMsIHBhY2thZ2VzV2l0aFZlcnNpb24sIHdobykge1xuICAgICAgICBpZiAoIXRoaXMuY2hlY2tQYWNrYWdlcyhwYWNrYWdlcykpIHtcbiAgICAgICAgICAgIHRoaXMubG9nLndhcm4oYCR7d2hvfSByZXF1aXJlcyBzb21lIHBhY2thZ2VzIHRoYXQgYXJlIG5vdCBhZGRlZCB0byBwcm9qZWN0LCB3aWxsIHRyeSB0byBhZGQgdGhlbSBub3dgKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRQYWNrYWdlcyhwYWNrYWdlcywgcGFja2FnZXNXaXRoVmVyc2lvbik7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jaGVja1BhY2thZ2VzVmVyc2lvbihwYWNrYWdlc1dpdGhWZXJzaW9uKSkge1xuICAgICAgICAgICAgdGhpcy5sb2cud2FybihgJHt3aG99IHJlcXVpcmVkIHBhY2thZ2VzIHZlcnNpb24gaXMgZGlmZmVyZW50LCBmaXhpbmcgaXRgKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRQYWNrYWdlcyhwYWNrYWdlcywgcGFja2FnZXNXaXRoVmVyc2lvbik7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBwYWNrYWdlcyBmcm9tIHRoZSBtZXRlb3IgYXBwLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2thZ2VzICAgICAgICAgICAgLSBhcnJheSB3aXRoIG5hbWVzIG9mIHRoZSBwYWNrYWdlcyB0byByZW1vdmVcbiAgICAgKi9cbiAgICBkZWxldGVQYWNrYWdlcyhwYWNrYWdlcykge1xuICAgICAgICB0aGlzLmxvZy53YXJuKCdyZW1vdmluZyBwYWNrYWdlcyBmcm9tIG1ldGVvciBwcm9qZWN0JywgLi4ucGFja2FnZXMpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgc3Bhd24oXG4gICAgICAgICAgICAgICAgJ21ldGVvcicsXG4gICAgICAgICAgICAgICAgWydyZW1vdmUnXS5jb25jYXQocGFja2FnZXMpLCB7XG4gICAgICAgICAgICAgICAgICAgIGN3ZDogdGhpcy4kLmVudi5wYXRocy5tZXRlb3JBcHAucm9vdCxcbiAgICAgICAgICAgICAgICAgICAgc3RkaW86IFsncGlwZScsICdwaXBlJywgcHJvY2Vzcy5zdGRlcnJdLFxuICAgICAgICAgICAgICAgICAgICBlbnY6IE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICB7IE1FVEVPUl9QUkVUVFlfT1VUUFVUOiAwLCBNRVRFT1JfTk9fUkVMRUFTRV9DSEVDSzogMSB9LCBwcm9jZXNzLmVudlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKS5vbignZXhpdCcsIChjb2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgIT09IDAgfHwgdGhpcy5jaGVja1BhY2thZ2VzKHBhY2thZ2VzKSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ3JlbW92aW5nIHBhY2thZ2VzIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBwYWNrYWdlcyB0byB0aGUgbWV0ZW9yIGFwcC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYWNrYWdlcyAgICAgICAgICAgIC0gYXJyYXkgd2l0aCBuYW1lcyBvZiB0aGUgcGFja2FnZXMgdG8gYWRkXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFja2FnZXNXaXRoVmVyc2lvbiAtIGFycmF5IHdpdGggbmFtZXMgYW5kIHZlcnNpb25zIG9mIHRoZSBwYWNrYWdlcyB0byBhZGRcbiAgICAgKi9cbiAgICBhZGRQYWNrYWdlcyhwYWNrYWdlcywgcGFja2FnZXNXaXRoVmVyc2lvbikge1xuICAgICAgICB0aGlzLmxvZy5pbmZvKCdhZGRpbmcgcGFja2FnZXMgdG8gbWV0ZW9yIHByb2plY3QnLCAuLi5wYWNrYWdlc1dpdGhWZXJzaW9uKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHNwYXduKFxuICAgICAgICAgICAgICAgICdtZXRlb3InLFxuICAgICAgICAgICAgICAgIFsnYWRkJ10uY29uY2F0KFxuICAgICAgICAgICAgICAgICAgICBwYWNrYWdlc1dpdGhWZXJzaW9uLm1hcChwYWNrYWdlTmFtZSA9PiBwYWNrYWdlTmFtZS5yZXBsYWNlKCdAJywgJ0A9JykpXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGN3ZDogdGhpcy4kLmVudi5wYXRocy5tZXRlb3JBcHAucm9vdCxcbiAgICAgICAgICAgICAgICAgICAgc3RkaW86IFsncGlwZScsICdwaXBlJywgcHJvY2Vzcy5zdGRlcnJdLFxuICAgICAgICAgICAgICAgICAgICBlbnY6IE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICB7IE1FVEVPUl9QUkVUVFlfT1VUUFVUOiAwLCBNRVRFT1JfTk9fUkVMRUFTRV9DSEVDSzogMSB9LCBwcm9jZXNzLmVudlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKS5vbignZXhpdCcsIChjb2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgIT09IDAgfHwgIXRoaXMuY2hlY2tQYWNrYWdlcyhwYWNrYWdlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdhZGRpbmcgcGFja2FnZXMgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEdBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFdBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUVBLElBQUFHLElBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QixTQUFBRCx1QkFBQUssR0FBQSxXQUFBQSxHQUFBLElBQUFBLEdBQUEsQ0FBQUMsVUFBQSxHQUFBRCxHQUFBLEtBQUFFLE9BQUEsRUFBQUYsR0FBQTtBQUx4Qjs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDZSxNQUFNRyxhQUFhLENBQUM7RUFDL0I7QUFDSjtBQUNBO0FBQ0E7RUFDSUMsV0FBV0EsQ0FBQ0MsQ0FBQyxFQUFFO0lBQ1gsSUFBSSxDQUFDQyxHQUFHLEdBQUcsSUFBSUMsWUFBRyxDQUFDLGVBQWUsQ0FBQztJQUNuQyxJQUFJLENBQUNGLENBQUMsR0FBR0EsQ0FBQztFQUNkOztFQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNJRyxh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